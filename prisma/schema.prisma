generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Student {
  id        Int                  @id @default(autoincrement())
  studentId String               @unique // ใช้แทน ID Card ในระบบ (เช่น 65062264)
  name      String
  password  String
  bookings  BookingParticipant[]
  createdAt DateTime             @default(now())
}

model Room {
  id        Int       @id @default(autoincrement())
  name      String
  capacity  Int
  location  String?
  bookings  Booking[]
  createdAt DateTime  @default(now())
}

model Booking {
  id           Int           @id @default(autoincrement())
  roomId       Int
  roomName     String 
  roomCapacity Int 
  startTime    DateTime
  endTime      DateTime
  status       BookingStatus @default(PENDING)

  participants BookingParticipant[]
  room         Room                 @relation(fields: [roomId], references: [id])
  createdAt    DateTime             @default(now())
  updatedAt    DateTime             @updatedAt
}

model BookingParticipant {
  id        Int @id @default(autoincrement())
  studentId Int
  bookingId Int

  student Student @relation(fields: [studentId], references: [id])
  booking Booking @relation(fields: [bookingId], references: [id])

  @@unique([studentId, bookingId]) // กันนักศึกษาเดิมจองซ้ำใน booking เดียว
}

enum BookingStatus {
  PENDING // รอการอนุมัติ
  CONFIRMED // ยืนยันแล้ว (จองสำเร็จ)
  CANCELED // ยกเลิกการจอง
}
